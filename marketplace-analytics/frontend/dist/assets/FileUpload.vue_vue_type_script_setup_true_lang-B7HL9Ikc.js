import{b as c,o as u,e as a,x as d,d as V,a as v,c as D,h as S,p as A,j as C,f as w,i as _,I as E,k as L,t as x,F as N,D as I}from"./index-0NWX--hT.js";function T(f,r){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}function U(f,r){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})])}class H{async uploadFile(r,m){const s=new FormData;return s.append("file",r),s.append("marketplace",m),d.uploadFile("/uploads",s)}async getReports(){return d.get("/uploads")}async getReport(r){return d.get(`/uploads/${r}`)}async deleteReport(r){return d.delete(`/uploads/${r}`)}async deleteAllReports(){return d.delete("/uploads")}async replaceReport(r,m,s){const p=new FormData;return p.append("file",m),p.append("marketplace",s),d.uploadFile(`/uploads/${r}/replace`,p)}}const ae=new H,G={class:"w-full"},K=["accept","multiple"],O={class:"space-y-2"},Z={class:"text-xs text-gray-500"},q={key:0,class:"mt-4 space-y-2"},J={class:"space-y-1"},P={class:"flex items-center space-x-2"},Q={class:"text-sm text-gray-900"},W={class:"text-xs text-gray-500"},X=["onClick"],Y={key:1,class:"mt-2 text-sm text-red-600"},oe=V({__name:"FileUpload",props:{accept:{default:".xlsx,.xls,.csv"},multiple:{type:Boolean,default:!1},maxSize:{default:52428800},maxFiles:{default:1}},emits:["filesSelected","error"],setup(f,{expose:r,emit:m}){const s=f,p=m,g=v(),i=v([]),h=v(!1),n=v(""),$=D(()=>`Поддерживаемые форматы: ${s.accept.split(",").map(e=>e.trim().toUpperCase()).join(", ")} (макс. ${y(s.maxSize)})`),b=D(()=>[h.value?"border-primary-400 bg-primary-50":"border-gray-300",n.value?"border-red-300":""]),B=t=>{var o;t.preventDefault(),h.value=!1;const e=Array.from(((o=t.dataTransfer)==null?void 0:o.files)||[]);F(e)},z=()=>{h.value=!1},M=t=>{const e=t.target,o=Array.from(e.files||[]);F(o)},F=t=>{var o;if(n.value="",!s.multiple&&t.length>1){n.value="Можно выбрать только один файл";return}if(t.length>s.maxFiles){n.value=`Можно выбрать не более ${s.maxFiles} файл(ов)`;return}const e=[];for(const l of t){if(l.size>s.maxSize){n.value=`Файл "${l.name}" слишком большой. Максимальный размер: ${y(s.maxSize)}`;continue}const k="."+((o=l.name.split(".").pop())==null?void 0:o.toLowerCase());if(!s.accept.split(",").map(R=>R.trim().toLowerCase()).includes(k)){n.value=`Файл "${l.name}" имеет неподдерживаемый формат`;continue}e.push(l)}e.length>0&&(i.value=s.multiple?[...i.value,...e]:e,p("filesSelected",i.value))},j=t=>{i.value.splice(t,1),p("filesSelected",i.value)},y=t=>{if(t===0)return"0 Bytes";const e=1024,o=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,l)).toFixed(2))+" "+o[l]};return r({clearFiles:()=>{i.value=[],n.value="",g.value&&(g.value.value="")}}),(t,e)=>(u(),c("div",G,[a("div",{onDrop:B,onDragover:e[0]||(e[0]=C(()=>{},["prevent"])),onDragenter:e[1]||(e[1]=C(()=>{},["prevent"])),onDragleave:z,class:A([b.value,"relative border-2 border-dashed rounded-lg p-6 text-center hover:border-primary-400 focus:border-primary-400 focus:ring-2 focus:ring-primary-200 focus:outline-none transition-colors duration-200"])},[a("input",{ref_key:"fileInput",ref:g,type:"file",accept:t.accept,multiple:t.multiple,onChange:M,class:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"},null,40,K),a("div",O,[w(_(E),{class:"mx-auto h-12 w-12 text-gray-400"}),e[2]||(e[2]=a("div",{class:"text-sm text-gray-600"},[a("span",{class:"font-medium text-primary-600 hover:text-primary-500"},"Нажмите для выбора"),L(" или перетащите файлы сюда ")],-1)),a("p",Z,x($.value),1)])],34),i.value.length>0?(u(),c("div",q,[e[3]||(e[3]=a("h4",{class:"text-sm font-medium text-gray-900"},"Выбранные файлы:",-1)),a("div",J,[(u(!0),c(N,null,I(i.value,(o,l)=>(u(),c("div",{key:l,class:"flex items-center justify-between p-2 bg-gray-50 rounded-md"},[a("div",P,[w(_(T),{class:"h-5 w-5 text-gray-400"}),a("span",Q,x(o.name),1),a("span",W,"("+x(y(o.size))+")",1)]),a("button",{onClick:k=>j(l),class:"text-gray-400 hover:text-red-500 transition-colors"},[w(_(U),{class:"h-4 w-4"})],8,X)]))),128))])])):S("",!0),n.value?(u(),c("div",Y,x(n.value),1)):S("",!0)]))}});export{oe as _,T as a,U as r,ae as u};
//# sourceMappingURL=FileUpload.vue_vue_type_script_setup_true_lang-B7HL9Ikc.js.map
