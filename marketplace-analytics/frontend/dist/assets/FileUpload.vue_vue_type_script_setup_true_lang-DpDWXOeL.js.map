{"version":3,"file":"FileUpload.vue_vue_type_script_setup_true_lang-DpDWXOeL.js","sources":["../../node_modules/@heroicons/vue/24/outline/esm/DocumentIcon.js","../../node_modules/@heroicons/vue/24/outline/esm/XMarkIcon.js","../../src/services/uploads.ts","../../src/components/ui/FileUpload.vue"],"sourcesContent":["import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport default function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    \"stroke-width\": \"1.5\",\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\"\n  }, [\n    _createElementVNode(\"path\", {\n      \"stroke-linecap\": \"round\",\n      \"stroke-linejoin\": \"round\",\n      d: \"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z\"\n    })\n  ]))\n}","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport default function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    \"stroke-width\": \"1.5\",\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\"\n  }, [\n    _createElementVNode(\"path\", {\n      \"stroke-linecap\": \"round\",\n      \"stroke-linejoin\": \"round\",\n      d: \"M6 18 18 6M6 6l12 12\"\n    })\n  ]))\n}","import { apiService } from './api'\nimport type { Report, Marketplace } from '@shared/types'\n\nclass UploadsService {\n  async uploadFile(file: File, marketplace: Marketplace) {\n    const formData = new FormData()\n    formData.append('file', file)\n    formData.append('marketplace', marketplace)\n    \n    return apiService.uploadFile('/uploads', formData)\n  }\n\n  async getReports(): Promise<Report[]> {\n    return apiService.get<Report[]>('/uploads')\n  }\n\n  async getReport(id: string): Promise<Report> {\n    return apiService.get<Report>(`/uploads/${id}`)\n  }\n\n  async deleteReport(id: string) {\n    return apiService.delete(`/uploads/${id}`)\n  }\n\n  async deleteAllReports() {\n    return apiService.delete('/uploads')\n  }\n\n  async replaceReport(id: string, file: File, marketplace: Marketplace) {\n    const formData = new FormData()\n    formData.append('file', file)\n    formData.append('marketplace', marketplace)\n    \n    return apiService.uploadFile(`/uploads/${id}/replace`, formData)\n  }\n}\n\nexport const uploadsService = new UploadsService()","<template>\n  <div class=\"w-full\">\n    <div\n      @drop=\"onDrop\"\n      @dragover.prevent\n      @dragenter.prevent\n      @dragleave=\"onDragLeave\"\n      :class=\"dropzoneClasses\"\n      class=\"relative border-2 border-dashed rounded-lg p-6 text-center hover:border-primary-400 focus:border-primary-400 focus:ring-2 focus:ring-primary-200 focus:outline-none transition-colors duration-200\"\n    >\n      <input\n        ref=\"fileInput\"\n        type=\"file\"\n        :accept=\"accept\"\n        :multiple=\"multiple\"\n        @change=\"onFileSelect\"\n        class=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\n      />\n      \n      <div class=\"space-y-2\">\n        <CloudArrowUpIcon class=\"mx-auto h-12 w-12 text-gray-400\" />\n        <div class=\"text-sm text-gray-600\">\n          <span class=\"font-medium text-primary-600 hover:text-primary-500\">Нажмите для выбора</span>\n          или перетащите файлы сюда\n        </div>\n        <p class=\"text-xs text-gray-500\">{{ acceptText }}</p>\n      </div>\n    </div>\n    \n    <!-- Selected files -->\n    <div v-if=\"selectedFiles.length > 0\" class=\"mt-4 space-y-2\">\n      <h4 class=\"text-sm font-medium text-gray-900\">Выбранные файлы:</h4>\n      <div class=\"space-y-1\">\n        <div\n          v-for=\"(file, index) in selectedFiles\"\n          :key=\"index\"\n          class=\"flex items-center justify-between p-2 bg-gray-50 rounded-md\"\n        >\n          <div class=\"flex items-center space-x-2\">\n            <DocumentIcon class=\"h-5 w-5 text-gray-400\" />\n            <span class=\"text-sm text-gray-900\">{{ file.name }}</span>\n            <span class=\"text-xs text-gray-500\">({{ formatFileSize(file.size) }})</span>\n          </div>\n          <button\n            @click=\"removeFile(index)\"\n            class=\"text-gray-400 hover:text-red-500 transition-colors\"\n          >\n            <XMarkIcon class=\"h-4 w-4\" />\n          </button>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Error message -->\n    <div v-if=\"error\" class=\"mt-2 text-sm text-red-600\">\n      {{ error }}\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport { CloudArrowUpIcon, DocumentIcon, XMarkIcon } from '@heroicons/vue/24/outline'\n\ninterface Props {\n  accept?: string\n  multiple?: boolean\n  maxSize?: number // in bytes\n  maxFiles?: number\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  accept: '.xlsx,.xls,.csv',\n  multiple: false,\n  maxSize: 52428800, // 50MB\n  maxFiles: 1,\n})\n\nconst emit = defineEmits<{\n  filesSelected: [files: File[]]\n  error: [message: string]\n}>()\n\nconst fileInput = ref<HTMLInputElement>()\nconst selectedFiles = ref<File[]>([])\nconst isDragOver = ref(false)\nconst error = ref('')\n\nconst acceptText = computed(() => {\n  const extensions = props.accept.split(',').map(ext => ext.trim().toUpperCase())\n  return `Поддерживаемые форматы: ${extensions.join(', ')} (макс. ${formatFileSize(props.maxSize)})`\n})\n\nconst dropzoneClasses = computed(() => [\n  isDragOver.value ? 'border-primary-400 bg-primary-50' : 'border-gray-300',\n  error.value ? 'border-red-300' : '',\n])\n\nconst onDrop = (e: DragEvent) => {\n  e.preventDefault()\n  isDragOver.value = false\n  \n  const files = Array.from(e.dataTransfer?.files || [])\n  handleFiles(files)\n}\n\nconst onDragLeave = () => {\n  isDragOver.value = false\n}\n\nconst onFileSelect = (e: Event) => {\n  const target = e.target as HTMLInputElement\n  const files = Array.from(target.files || [])\n  handleFiles(files)\n}\n\nconst handleFiles = (files: File[]) => {\n  error.value = ''\n  \n  // Validate file count\n  if (!props.multiple && files.length > 1) {\n    error.value = 'Можно выбрать только один файл'\n    return\n  }\n  \n  if (files.length > props.maxFiles) {\n    error.value = `Можно выбрать не более ${props.maxFiles} файл(ов)`\n    return\n  }\n  \n  // Validate each file\n  const validFiles: File[] = []\n  \n  for (const file of files) {\n    // Check file size\n    if (file.size > props.maxSize) {\n      error.value = `Файл \"${file.name}\" слишком большой. Максимальный размер: ${formatFileSize(props.maxSize)}`\n      continue\n    }\n    \n    // Check file type\n    const fileExtension = '.' + file.name.split('.').pop()?.toLowerCase()\n    const allowedExtensions = props.accept.split(',').map(ext => ext.trim().toLowerCase())\n    \n    if (!allowedExtensions.includes(fileExtension)) {\n      error.value = `Файл \"${file.name}\" имеет неподдерживаемый формат`\n      continue\n    }\n    \n    validFiles.push(file)\n  }\n  \n  if (validFiles.length > 0) {\n    selectedFiles.value = props.multiple ? [...selectedFiles.value, ...validFiles] : validFiles\n    emit('filesSelected', selectedFiles.value)\n  }\n}\n\nconst removeFile = (index: number) => {\n  selectedFiles.value.splice(index, 1)\n  emit('filesSelected', selectedFiles.value)\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 Bytes'\n  \n  const k = 1024\n  const sizes = ['Bytes', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  \n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n}\n\n// Clear files method (can be called from parent)\nconst clearFiles = () => {\n  selectedFiles.value = []\n  error.value = ''\n  if (fileInput.value) {\n    fileInput.value.value = ''\n  }\n}\n\ndefineExpose({ clearFiles })\n</script>"],"names":["render","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","UploadsService","file","marketplace","formData","apiService","id","uploadsService","props","__props","emit","__emit","fileInput","ref","selectedFiles","isDragOver","error","acceptText","computed","ext","formatFileSize","dropzoneClasses","onDrop","e","files","_a","handleFiles","onDragLeave","onFileSelect","target","validFiles","fileExtension","removeFile","index","bytes","k","sizes","i","__expose","_hoisted_1","_normalizeClass","accept","multiple","_hoisted_3","_createVNode","_unref","CloudArrowUpIcon","_hoisted_4","_toDisplayString","_hoisted_5","_hoisted_6","_Fragment","_renderList","_hoisted_7","DocumentIcon","_hoisted_8","_hoisted_9","$event","XMarkIcon","_hoisted_11"],"mappings":"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","x_google_ignoreList":[0,1]}