{"version":3,"file":"UploadView-BT2kyfIj.js","sources":["../../node_modules/@heroicons/vue/24/outline/esm/CheckCircleIcon.js","../../node_modules/@heroicons/vue/24/outline/esm/InformationCircleIcon.js","../../src/views/UploadView.vue"],"sourcesContent":["import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport default function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    \"stroke-width\": \"1.5\",\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\"\n  }, [\n    _createElementVNode(\"path\", {\n      \"stroke-linecap\": \"round\",\n      \"stroke-linejoin\": \"round\",\n      d: \"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\n    })\n  ]))\n}","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport default function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    \"stroke-width\": \"1.5\",\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\"\n  }, [\n    _createElementVNode(\"path\", {\n      \"stroke-linecap\": \"round\",\n      \"stroke-linejoin\": \"round\",\n      d: \"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z\"\n    })\n  ]))\n}","<template>\n  <div class=\"max-w-4xl mx-auto space-y-6\">\n    <!-- Header -->\n    <div class=\"text-center\">\n      <h1 class=\"text-3xl font-bold text-gray-900\">Загрузить отчет</h1>\n      <p class=\"mt-2 text-lg text-gray-600\">\n        Загрузите файл с данными продаж для анализа прибыльности\n      </p>\n    </div>\n\n    <!-- Upload form -->\n    <div class=\"card\">\n      <div class=\"card-body\">\n        <form @submit.prevent=\"handleUpload\" class=\"space-y-6\">\n          <!-- Marketplace selection -->\n          <div>\n            <label class=\"form-label\">Маркетплейс</label>\n            <div class=\"mt-2 space-y-2\">\n              <div class=\"flex items-center\">\n                <input\n                  id=\"wildberries\"\n                  v-model=\"selectedMarketplace\"\n                  name=\"marketplace\"\n                  type=\"radio\"\n                  value=\"WILDBERRIES\"\n                  class=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label for=\"wildberries\" class=\"ml-3 block text-sm font-medium text-gray-700\">\n                  Wildberries\n                </label>\n              </div>\n              <div class=\"flex items-center\">\n                <input\n                  id=\"ozon\"\n                  v-model=\"selectedMarketplace\"\n                  name=\"marketplace\"\n                  type=\"radio\"\n                  value=\"OZON\"\n                  class=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label for=\"ozon\" class=\"ml-3 block text-sm font-medium text-gray-700\">\n                  Ozon\n                </label>\n              </div>\n            </div>\n          </div>\n\n          <!-- File upload -->\n          <div>\n            <label class=\"form-label\">Файл с данными продаж</label>\n            <FileUpload\n              ref=\"fileUploadRef\"\n              accept=\".xlsx,.xls,.csv\"\n              :max-size=\"52428800\"\n              @files-selected=\"onFilesSelected\"\n              @error=\"onUploadError\"\n            />\n          </div>\n\n          <!-- Expected columns info -->\n          <div v-if=\"selectedMarketplace\" class=\"bg-blue-50 border border-blue-200 rounded-md p-4\">\n            <div class=\"flex\">\n              <InformationCircleIcon class=\"h-5 w-5 text-blue-400\" />\n              <div class=\"ml-3\">\n                <h3 class=\"text-sm font-medium text-blue-800\">\n                  Ожидаемые колонки для {{ marketplaceName }}\n                </h3>\n                <div class=\"mt-2 text-sm text-blue-700\">\n                  <ul class=\"list-disc list-inside space-y-1\">\n                    <li v-for=\"column in expectedColumns\" :key=\"column\">{{ column }}</li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <!-- Submit button -->\n          <div class=\"flex justify-end\">\n            <BaseButton\n              type=\"submit\"\n              variant=\"primary\"\n              :loading=\"uploading\"\n              :disabled=\"!canUpload\"\n              size=\"lg\"\n            >\n              <CloudArrowUpIcon class=\"h-5 w-5 mr-2\" />\n              Загрузить и обработать\n            </BaseButton>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <!-- Upload progress -->\n    <div v-if=\"uploading\" class=\"card\">\n      <div class=\"card-body\">\n        <div class=\"flex items-center\">\n          <div class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"></div>\n          <div class=\"ml-4\">\n            <h3 class=\"text-lg font-medium text-gray-900\">Обработка файла...</h3>\n            <p class=\"text-sm text-gray-600\">Это может занять до 30 секунд</p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Success message -->\n    <div v-if=\"uploadSuccess\" class=\"rounded-md bg-green-50 p-4\">\n      <div class=\"flex\">\n        <CheckCircleIcon class=\"h-5 w-5 text-green-400\" />\n        <div class=\"ml-3\">\n          <h3 class=\"text-sm font-medium text-green-800\">Файл успешно загружен!</h3>\n          <div class=\"mt-2 text-sm text-green-700\">\n            <p>Файл отправлен на обработку. Результаты будут доступны в разделе \"Отчеты\".</p>\n          </div>\n          <div class=\"mt-4\">\n            <div class=\"flex space-x-3\">\n              <BaseButton\n                variant=\"outline\"\n                size=\"sm\"\n                @click=\"$router.push('/reports')\"\n              >\n                Перейти к отчетам\n              </BaseButton>\n              <BaseButton\n                variant=\"outline\"\n                size=\"sm\"\n                @click=\"uploadAnother\"\n              >\n                Загрузить еще файл\n              </BaseButton>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Error message -->\n    <div v-if=\"error\" class=\"rounded-md bg-red-50 p-4\">\n      <div class=\"flex\">\n        <ExclamationTriangleIcon class=\"h-5 w-5 text-red-400\" />\n        <div class=\"ml-3\">\n          <h3 class=\"text-sm font-medium text-red-800\">Ошибка загрузки</h3>\n          <div class=\"mt-2 text-sm text-red-700\">\n            <p>{{ error }}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Help section -->\n    <div class=\"card\">\n      <div class=\"card-header\">\n        <h3 class=\"text-lg font-medium text-gray-900\">Как подготовить файл для загрузки?</h3>\n      </div>\n      <div class=\"card-body\">\n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <h4 class=\"text-base font-medium text-gray-900 mb-3\">Wildberries</h4>\n            <ol class=\"list-decimal list-inside space-y-2 text-sm text-gray-600\">\n              <li>Войдите в личный кабинет продавца WB</li>\n              <li>Перейдите в раздел \"Аналитика\" → \"Продажи\"</li>\n              <li>Выберите нужный период</li>\n              <li>Скачайте отчет в формате Excel или CSV</li>\n              <li>Загрузите файл на нашу платформу</li>\n            </ol>\n          </div>\n          \n          <div>\n            <h4 class=\"text-base font-medium text-gray-900 mb-3\">Ozon</h4>\n            <ol class=\"list-decimal list-inside space-y-2 text-sm text-gray-600\">\n              <li>Войдите в личный кабинет продавца Ozon</li>\n              <li>Перейдите в раздел \"Аналитика\" → \"Продажи и заказы\"</li>\n              <li>Выберите нужный период</li>\n              <li>Экспортируйте данные в Excel или CSV</li>\n              <li>Загрузите файл на нашу платформу</li>\n            </ol>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport { uploadsService } from '@/services/uploads'\nimport { Marketplace } from '@shared/types'\nimport FileUpload from '@/components/ui/FileUpload.vue'\nimport BaseButton from '@/components/ui/BaseButton.vue'\nimport {\n  CloudArrowUpIcon,\n  InformationCircleIcon,\n  CheckCircleIcon,\n  ExclamationTriangleIcon,\n} from '@heroicons/vue/24/outline'\n\nconst selectedMarketplace = ref<Marketplace | ''>('')\nconst selectedFiles = ref<File[]>([])\nconst uploading = ref(false)\nconst uploadSuccess = ref(false)\nconst error = ref('')\n\nconst fileUploadRef = ref()\n\nconst marketplaceName = computed(() => {\n  return selectedMarketplace.value === 'WILDBERRIES' ? 'Wildberries' : 'Ozon'\n})\n\nconst expectedColumns = computed(() => {\n  if (selectedMarketplace.value === 'WILDBERRIES') {\n    return [\n      'Дата продажи',\n      'Артикул WB',\n      'Наименование',\n      'Цена продажи',\n      'Количество',\n      'Комиссия WB',\n    ]\n  } else if (selectedMarketplace.value === 'OZON') {\n    return [\n      'Дата',\n      'Артикул',\n      'Название товара',\n      'Цена за единицу',\n      'Количество',\n      'Комиссия за продажу',\n    ]\n  }\n  return []\n})\n\nconst canUpload = computed(() => {\n  return selectedMarketplace.value && selectedFiles.value.length > 0 && !uploading.value\n})\n\nconst onFilesSelected = (files: File[]) => {\n  selectedFiles.value = files\n  error.value = ''\n}\n\nconst onUploadError = (message: string) => {\n  error.value = message\n}\n\nconst handleUpload = async () => {\n  if (!canUpload.value) return\n\n  try {\n    uploading.value = true\n    error.value = ''\n    uploadSuccess.value = false\n\n    await uploadsService.uploadFile(\n      selectedFiles.value[0],\n      selectedMarketplace.value as Marketplace\n    )\n\n    uploadSuccess.value = true\n    selectedFiles.value = []\n    selectedMarketplace.value = ''\n    \n    // Clear the file upload component\n    if (fileUploadRef.value) {\n      fileUploadRef.value.clearFiles()\n    }\n  } catch (err: any) {\n    error.value = err.response?.data?.message || 'Произошла ошибка при загрузке файла'\n  } finally {\n    uploading.value = false\n  }\n}\n\nconst uploadAnother = () => {\n  uploadSuccess.value = false\n  error.value = ''\n  selectedFiles.value = []\n  selectedMarketplace.value = ''\n  \n  if (fileUploadRef.value) {\n    fileUploadRef.value.clearFiles()\n  }\n}\n</script>"],"names":["render","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","selectedMarketplace","ref","selectedFiles","uploading","uploadSuccess","error","fileUploadRef","marketplaceName","computed","expectedColumns","canUpload","onFilesSelected","files","onUploadError","message","handleUpload","uploadsService","err","_b","_a","uploadAnother","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","$event","_hoisted_6","_createVNode","FileUpload","_hoisted_7","_hoisted_8","_unref","InformationCircleIcon","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_Fragment","_renderList","column","_hoisted_13","BaseButton","CloudArrowUpIcon","_hoisted_14","_hoisted_15","_hoisted_16","CheckCircleIcon","_hoisted_17","_hoisted_18","_hoisted_19","$router","_hoisted_20","_hoisted_21","ExclamationTriangleIcon","_hoisted_22","_hoisted_23"],"mappings":"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","x_google_ignoreList":[0,1]}