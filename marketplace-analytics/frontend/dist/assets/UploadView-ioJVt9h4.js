import{b as a,o as i,e,d as q,a as n,c as f,h as p,g as k,j as N,n as B,A as C,f as r,i as x,t as g,F as O,y as U,w as y,k as b,C as F}from"./index-C06cxT_l.js";import{_ as $,u as I}from"./FileUpload.vue_vue_type_script_setup_true_lang-DpDWXOeL.js";import{_}from"./BaseButton.vue_vue_type_script_setup_true_lang-BdOSKptw.js";import{r as M}from"./ExclamationTriangleIcon-DG5ZDN47.js";function D(h,t){return i(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function Z(h,t){return i(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})])}const j={class:"max-w-4xl mx-auto space-y-6"},L={class:"card"},A={class:"card-body"},H={class:"mt-2 space-y-2"},T={class:"flex items-center"},G={class:"flex items-center"},J={key:0,class:"bg-blue-50 border border-blue-200 rounded-md p-4"},K={class:"flex"},P={class:"ml-3"},Q={class:"text-sm font-medium text-blue-800"},X={class:"mt-2 text-sm text-blue-700"},Y={class:"list-disc list-inside space-y-1"},ee={class:"flex justify-end"},se={key:0,class:"card"},te={key:1,class:"rounded-md bg-green-50 p-4"},le={class:"flex"},ae={class:"ml-3"},ie={class:"mt-4"},oe={class:"flex space-x-3"},re={key:2,class:"rounded-md bg-red-50 p-4"},de={class:"flex"},ne={class:"ml-3"},ue={class:"mt-2 text-sm text-red-700"},xe=q({__name:"UploadView",setup(h){const t=n(""),u=n([]),c=n(!1),m=n(!1),d=n(""),v=n(),E=f(()=>t.value==="WILDBERRIES"?"Wildberries":"Ozon"),S=f(()=>t.value==="WILDBERRIES"?["Дата продажи","Артикул WB","Наименование","Цена продажи","Количество","Комиссия WB"]:t.value==="OZON"?["Дата","Артикул","Название товара","Цена за единицу","Количество","Комиссия за продажу"]:[]),w=f(()=>t.value&&u.value.length>0&&!c.value),V=o=>{u.value=o,d.value=""},z=o=>{d.value=o},R=async()=>{var o,s;if(w.value)try{c.value=!0,d.value="",m.value=!1,await I.uploadFile(u.value[0],t.value),m.value=!0,u.value=[],t.value="",v.value&&v.value.clearFiles()}catch(l){d.value=((s=(o=l.response)==null?void 0:o.data)==null?void 0:s.message)||"Произошла ошибка при загрузке файла"}finally{c.value=!1}},W=()=>{m.value=!1,d.value="",u.value=[],t.value="",v.value&&v.value.clearFiles()};return(o,s)=>(i(),a("div",j,[s[14]||(s[14]=e("div",{class:"text-center"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Загрузить отчет"),e("p",{class:"mt-2 text-lg text-gray-600"}," Загрузите файл с данными продаж для анализа прибыльности ")],-1)),e("div",L,[e("div",A,[e("form",{onSubmit:N(R,["prevent"]),class:"space-y-6"},[e("div",null,[s[5]||(s[5]=e("label",{class:"form-label"},"Маркетплейс",-1)),e("div",H,[e("div",T,[B(e("input",{id:"wildberries","onUpdate:modelValue":s[0]||(s[0]=l=>t.value=l),name:"marketplace",type:"radio",value:"WILDBERRIES",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"},null,512),[[C,t.value]]),s[3]||(s[3]=e("label",{for:"wildberries",class:"ml-3 block text-sm font-medium text-gray-700"}," Wildberries ",-1))]),e("div",G,[B(e("input",{id:"ozon","onUpdate:modelValue":s[1]||(s[1]=l=>t.value=l),name:"marketplace",type:"radio",value:"OZON",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"},null,512),[[C,t.value]]),s[4]||(s[4]=e("label",{for:"ozon",class:"ml-3 block text-sm font-medium text-gray-700"}," Ozon ",-1))])])]),e("div",null,[s[6]||(s[6]=e("label",{class:"form-label"},"Файл с данными продаж",-1)),r($,{ref_key:"fileUploadRef",ref:v,accept:".xlsx,.xls,.csv","max-size":52428800,onFilesSelected:V,onError:z},null,512)]),t.value?(i(),a("div",J,[e("div",K,[r(x(Z),{class:"h-5 w-5 text-blue-400"}),e("div",P,[e("h3",Q," Ожидаемые колонки для "+g(E.value),1),e("div",X,[e("ul",Y,[(i(!0),a(O,null,U(S.value,l=>(i(),a("li",{key:l},g(l),1))),128))])])])])])):p("",!0),e("div",ee,[r(_,{type:"submit",variant:"primary",loading:c.value,disabled:!w.value,size:"lg"},{default:y(()=>[r(x(F),{class:"h-5 w-5 mr-2"}),s[7]||(s[7]=b(" Загрузить и обработать ",-1))]),_:1},8,["loading","disabled"])])],32)])]),c.value?(i(),a("div",se,[...s[8]||(s[8]=[k('<div class="card-body"><div class="flex items-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div><div class="ml-4"><h3 class="text-lg font-medium text-gray-900">Обработка файла...</h3><p class="text-sm text-gray-600">Это может занять до 30 секунд</p></div></div></div>',1)])])):p("",!0),m.value?(i(),a("div",te,[e("div",le,[r(x(D),{class:"h-5 w-5 text-green-400"}),e("div",ae,[s[11]||(s[11]=e("h3",{class:"text-sm font-medium text-green-800"},"Файл успешно загружен!",-1)),s[12]||(s[12]=e("div",{class:"mt-2 text-sm text-green-700"},[e("p",null,'Файл отправлен на обработку. Результаты будут доступны в разделе "Отчеты".')],-1)),e("div",ie,[e("div",oe,[r(_,{variant:"outline",size:"sm",onClick:s[2]||(s[2]=l=>o.$router.push("/reports"))},{default:y(()=>[...s[9]||(s[9]=[b(" Перейти к отчетам ",-1)])]),_:1}),r(_,{variant:"outline",size:"sm",onClick:W},{default:y(()=>[...s[10]||(s[10]=[b(" Загрузить еще файл ",-1)])]),_:1})])])])])])):p("",!0),d.value?(i(),a("div",re,[e("div",de,[r(x(M),{class:"h-5 w-5 text-red-400"}),e("div",ne,[s[13]||(s[13]=e("h3",{class:"text-sm font-medium text-red-800"},"Ошибка загрузки",-1)),e("div",ue,[e("p",null,g(d.value),1)])])])])):p("",!0),s[15]||(s[15]=k('<div class="card"><div class="card-header"><h3 class="text-lg font-medium text-gray-900">Как подготовить файл для загрузки?</h3></div><div class="card-body"><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><h4 class="text-base font-medium text-gray-900 mb-3">Wildberries</h4><ol class="list-decimal list-inside space-y-2 text-sm text-gray-600"><li>Войдите в личный кабинет продавца WB</li><li>Перейдите в раздел &quot;Аналитика&quot; → &quot;Продажи&quot;</li><li>Выберите нужный период</li><li>Скачайте отчет в формате Excel или CSV</li><li>Загрузите файл на нашу платформу</li></ol></div><div><h4 class="text-base font-medium text-gray-900 mb-3">Ozon</h4><ol class="list-decimal list-inside space-y-2 text-sm text-gray-600"><li>Войдите в личный кабинет продавца Ozon</li><li>Перейдите в раздел &quot;Аналитика&quot; → &quot;Продажи и заказы&quot;</li><li>Выберите нужный период</li><li>Экспортируйте данные в Excel или CSV</li><li>Загрузите файл на нашу платформу</li></ol></div></div></div></div>',1))]))}});export{xe as default};
//# sourceMappingURL=UploadView-ioJVt9h4.js.map
